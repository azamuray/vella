<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>VELLA - Zombie Shooter</title>

    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- Phaser.js -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>

    <!-- Custom joysticks (no external library needed) -->

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- Loading screen -->
    <div id="loading-screen">
        <div class="loader">
            <div class="zombie-icon">ğŸ§Ÿ</div>
            <h1>VELLA</h1>
            <p>Loading...</p>
            <div class="progress-bar">
                <div class="progress-fill" id="load-progress"></div>
            </div>
        </div>
    </div>

    <!-- Main menu -->
    <div id="menu-screen" class="screen hidden">
        <div class="menu-container">
            <h1 class="game-title">ğŸ§Ÿ VELLA</h1>
            <p class="subtitle">Zombie Survival</p>

            <div class="player-info">
                <div class="stat">
                    <span class="icon">ğŸ’°</span>
                    <span id="player-coins">0</span>
                </div>
                <div class="stat">
                    <span class="icon">ğŸ’€</span>
                    <span id="player-kills">0</span>
                </div>
                <div class="stat">
                    <span class="icon">ğŸŒŠ</span>
                    <span id="player-wave">0</span>
                </div>
            </div>

            <div class="menu-buttons">
                <button class="btn btn-primary" id="btn-create-room">
                    <span class="icon">â•</span> Create Room
                </button>
                <button class="btn btn-secondary" id="btn-browse-rooms">
                    <span class="icon">ğŸŒ</span> Browse Rooms
                </button>
                <button class="btn btn-secondary" id="btn-shop">
                    <span class="icon">ğŸ”«</span> Shop
                </button>
            </div>

            <div class="equipped-weapon">
                <span>Equipped: </span>
                <span id="equipped-weapon-name">Glock 17</span>
            </div>
        </div>
    </div>

    <!-- Lobby screen -->
    <div id="lobby-screen" class="screen hidden">
        <div class="lobby-container">
            <h2>Room: <span id="room-code">------</span></h2>
            <button class="btn-copy" id="btn-copy-code">ğŸ“‹ Copy</button>

            <div class="players-list" id="lobby-players">
                <!-- Players will be added here -->
            </div>

            <div class="lobby-buttons">
                <button class="btn btn-primary" id="btn-ready">
                    <span id="ready-text">Ready</span>
                </button>
                <button class="btn btn-danger" id="btn-leave">Leave</button>
            </div>

            <p class="lobby-hint">Press Ready to start (1-10 players)</p>
            <div class="controls-hint">
                <p>ğŸ•¹ï¸ Left joystick â€” Move</p>
                <p>ğŸ¯ Right joystick â€” Aim & Auto-shoot</p>
            </div>
        </div>
    </div>

    <!-- Shop screen -->
    <div id="shop-screen" class="screen hidden">
        <div class="shop-container">
            <div class="shop-header">
                <button class="btn-back" id="btn-shop-back">â† Back</button>
                <h2>Weapon Shop</h2>
                <div class="coins">ğŸ’° <span id="shop-coins">0</span></div>
            </div>

            <!-- Ready button in shop (only visible during wave break) -->
            <div id="shop-ready-bar" class="shop-ready-bar hidden">
                <span id="shop-ready-status">Waiting...</span>
                <button class="btn btn-primary btn-sm" id="btn-shop-ready">âœ“ Ready</button>
            </div>

            <div class="weapons-grid" id="weapons-list">
                <!-- Weapons will be added here -->
            </div>
        </div>
    </div>

    <!-- Browse rooms modal -->
    <div id="rooms-modal" class="modal hidden">
        <div class="modal-content rooms-modal">
            <h3>ğŸŒ Public Rooms</h3>
            <div class="rooms-list" id="rooms-list">
                <p class="loading-rooms">Loading...</p>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" id="btn-rooms-refresh">ğŸ”„ Refresh</button>
                <button class="btn btn-secondary" id="btn-rooms-cancel">Close</button>
            </div>
        </div>
    </div>

    <!-- Game container -->
    <div id="game-container" class="hidden"></div>

    <!-- Joystick zones (outside game canvas) -->
    <div id="joystick-left" class="joystick-zone hidden"></div>
    <div id="joystick-right" class="joystick-zone hidden"></div>

    <!-- HUD (overlay on game) -->
    <div id="hud" class="hidden">
        <!-- Debug button -->
        <button id="btn-kill-all" class="debug-btn">â˜ ï¸ Kill All</button>
        <div class="hud-top">
            <div class="wave-info">
                <span class="label">Wave</span>
                <span id="hud-wave">1</span>
            </div>
            <div class="zombies-info">
                <span class="label">ğŸ§Ÿ</span>
                <span id="hud-zombies">0</span>
            </div>
            <div class="kills-info">
                <span class="label">ğŸ’€</span>
                <span id="hud-kills">0</span>
            </div>
            <div class="coins-info">
                <span class="label">ğŸ’°</span>
                <span id="hud-coins">0</span>
            </div>
        </div>

        <div class="hud-bottom">
            <div class="health-bar">
                <div class="health-fill" id="hud-health"></div>
                <span class="health-text" id="hud-health-text">100/100</span>
            </div>
            <div class="ammo-info">
                <span id="hud-ammo">17</span> / <span id="hud-max-ammo">17</span>
                <span id="hud-weapon-name">Glock 17</span>
            </div>
            <div class="reload-bar hidden" id="reload-bar">
                <div class="reload-fill" id="reload-fill"></div>
            </div>
        </div>
    </div>

    <!-- Wave announcement -->
    <div id="wave-announcement" class="hidden">
        <h2>Wave <span id="announce-wave">1</span></h2>
        <p id="announce-zombies">10 zombies incoming</p>
    </div>

    <!-- Wave complete overlay -->
    <div id="wave-complete" class="screen hidden">
        <div class="wave-complete-container">
            <h2>Wave <span id="complete-wave">1</span> Complete!</h2>
            <div class="wave-bonus">+<span id="wave-bonus">50</span> coins</div>
            <p class="next-wave-text">Next: Wave <span id="next-wave-num">2</span></p>
            <p class="ready-status" id="ready-status">Waiting for players...</p>
            <div class="wave-complete-buttons">
                <button class="btn btn-primary" id="btn-next-wave">
                    âœ“ Ready
                </button>
                <button class="btn btn-secondary" id="btn-wave-shop">
                    ğŸ”« Shop
                </button>
            </div>
        </div>
    </div>

    <!-- Game over screen -->
    <div id="gameover-screen" class="screen hidden">
        <div class="gameover-container">
            <h1>Game Over</h1>
            <div class="final-stats">
                <div class="stat-row">
                    <span>Wave Reached</span>
                    <span id="final-wave">0</span>
                </div>
                <div class="stat-row">
                    <span>Total Kills</span>
                    <span id="final-kills">0</span>
                </div>
                <div class="stat-row">
                    <span>Coins Earned</span>
                    <span id="final-coins">0</span>
                </div>
            </div>

            <div class="leaderboard" id="final-leaderboard">
                <!-- Player stats will be added here -->
            </div>

            <button class="btn btn-primary" id="btn-play-again">Play Again</button>
            <button class="btn btn-secondary" id="btn-back-menu">Back to Menu</button>
        </div>
    </div>

    <script type="module" src="/js/main.js?v=17"></script>
</body>
</html>
